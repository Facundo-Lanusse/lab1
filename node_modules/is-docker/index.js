<<<<<<< HEAD
'use strict';
const fs = require('fs');

let isDocker;
=======
import fs from 'node:fs';

let isDockerCached;
>>>>>>> f7dcd41628dfb5dfbbd2d9329defc58313d35f41

function hasDockerEnv() {
	try {
		fs.statSync('/.dockerenv');
		return true;
<<<<<<< HEAD
	} catch (_) {
=======
	} catch {
>>>>>>> f7dcd41628dfb5dfbbd2d9329defc58313d35f41
		return false;
	}
}

function hasDockerCGroup() {
	try {
		return fs.readFileSync('/proc/self/cgroup', 'utf8').includes('docker');
<<<<<<< HEAD
	} catch (_) {
=======
	} catch {
>>>>>>> f7dcd41628dfb5dfbbd2d9329defc58313d35f41
		return false;
	}
}

<<<<<<< HEAD
module.exports = () => {
	if (isDocker === undefined) {
		isDocker = hasDockerEnv() || hasDockerCGroup();
	}

	return isDocker;
};
=======
export default function isDocker() {
	// TODO: Use `??=` when targeting Node.js 16.
	if (isDockerCached === undefined) {
		isDockerCached = hasDockerEnv() || hasDockerCGroup();
	}

	return isDockerCached;
}
>>>>>>> f7dcd41628dfb5dfbbd2d9329defc58313d35f41
